<header class="p-3 mb-3 border-bottom bg-white shadow-sm">
  <div class="container">
    <nav class="navbar navbar-expand-xl navbar-light">
      <!-- Logo thương hiệu -->
      <a href="/" class="navbar-brand d-flex align-items-center">
        <h1 class="text-primary display-6 mb-0">CleanFruit</h1>
      </a>

      <!-- Nút toggle menu trên mobile -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
        <span class="fa fa-bars text-primary"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarCollapse">
        <!-- Menu chính -->
        <div class="navbar-nav mx-auto">
          <a href="/" class="nav-item nav-link active">Trang Chủ</a>
          <a href="/shop" class="nav-item nav-link">Sản phẩm</a>
          <a href="/cart" class="nav-item nav-link">Giỏ hàng</a>
        </div>

        <!-- Thanh tìm kiếm -->
        <form action="/search" method="GET" class="d-flex me-3">
          <div class="input-group">
            <input class="form-control border-end-0" type="search" name="keyword" placeholder="Tìm kiếm..." aria-label="Search">
            <button type="submit" class="input-group-text bg-primary text-white border-0">
              <i class="fa fa-search"></i>
            </button>
          </div>
        </form>

        <!-- Icon giỏ hàng -->
        <a href="/cart" class="position-relative me-3">
          <i class="fa fa-shopping-bag fa-2x text-primary"></i>
          <span th:if="${cartCount > 0}" th:text="${cartCount}" 
                class="position-absolute bg-danger rounded-circle text-white px-2"
                style="top: -5px; left: 15px; height: 20px; min-width: 20px; font-size: 14px; line-height: 20px;">
          </span>
        </a>

        <!-- Dropdown người dùng -->
        <div class="nav-item dropdown">
          <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
            <img th:if="${session.user != null}" class="rounded-circle border" 
                 th:src="@{/images/{img}(img=${session.user?.photo ?: 'default.png'})}" width="40" height="40">
            <i th:if="${session.user == null}" class="fas fa-user fa-2x text-primary"></i>
          </a>

          <ul class="dropdown-menu dropdown-menu-end shadow-sm">
            <li th:if="${session.user == null}">
              <a class="dropdown-item" href="/login">Đăng nhập</a>
            </li>
            <li th:if="${session.user == null}">
              <a class="dropdown-item" href="/dangky">Đăng ký</a>
            </li>
            <li th:if="${session.user == null}">
              <a class="dropdown-item" href="/forgot-password">Quên mật khẩu </a>
            </li>
            <li th:if="${session.user != null}">
              <a class="dropdown-item" href="/profile" th:text="${session.user.fullname}"></a>
              <hr>
            </li>
            <li th:if="${session.user != null and session.user.admin == true}">
              <a class="dropdown-item" href="/admin/products">Quản lý</a>
            </li>
            <li th:if="${session.user != null}">
              <a class="dropdown-item" href="/order">Đơn hàng của bạn</a>
            </li>
            <li th:if="${session.user != null}">
              <a class="dropdown-item" href="/doimk">Đổi mật khẩu</a>
            </li>
            <li th:if="${session.user != null}">
              <a class="dropdown-item" href="/logout">Đăng xuất</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </div>
</header>
